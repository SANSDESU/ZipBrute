# Happy Cracking :3
#

greetzz = "echo                                  ██████████████████                                          && echo                              ████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██████                                    && echo                          ████░░░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒████                                && echo                        ██▒▒▒▒▒▒░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░██                              && echo                      ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░░░▒▒██                            && echo                    ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░▒▒▒▒██                          && echo                  ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██                          && echo                  ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██                        && echo                ▓▓▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██                        && echo                ████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██                        && echo            ████▒▒░░██▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒██▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██                      && echo        ████░░▒▒██░░░░██▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒██▒▒▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██                      && echo      ██▒▒░░▒▒████▒▒░░██▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒██▒▒▒▒▒▒██░░██▒▒▒▒██▒▒▒▒▒▒▒▒██                      && echo    ██▒▒▒▒▒▒████▒▒██░░░░██▒▒▒▒▒▒▒▒██▒▒▒▒██▒▒▒▒████░░░░██▒▒██░░██▒▒██▒▒██                      && echo    ██▒▒▒▒██▒▒██▒▒██▒▒██▒▒▒▒▒▒▒▒██▒▒▒▒▒▒██▒▒██▓▓░░░░░░████░░░░██▒▒██▒▒██                      && echo      ████▒▒▒▒██▒▒██▒▒██▒▒▒▒██████▒▒▒▒▒▒████░░░░▓▓▓▓░░░░░░░░░░██▒▒██▒▒██                      && echo    ▓▓▒▒▒▒▒▒██▒▒▒▒▒▒██▒▒▒▒██░░░░██▒▒▒▒██░░██████░░░░▓▓      ▓▓████▒▒██                        && echo    ██▒▒▒▒▒▒██▒▒▒▒▒▒▒▒██▒▒██░░░░▓▓░░▒▒████████▓▓██░░░░    ▓▓░░░░████                          && echo  ▓▓▒▒▒▒▒▒██▓▓██▒▒▒▒░░██▒▒██░░▓▓▒▒▒▒░░██  ▒▒██  ░░▓▓      ░░▓▓▓▓██                            && echo  ██▒▒▒▒░░██▒▒▒▒██░░██▒▒▒▒██░░██▒▒▒▒▒▒██  ▒▒▒▒▒▒          ████░░██                            && echo  ██▒▒▒▒░░██▒▒▒▒██░░██▒▒▒▒▒▒████▒▒▒▒▒▒██                    ▒▒  ██                            && echo    ████▓▓██▒▒▒▒▓▓████▒▒▒▒▒▒▓▓██▒▒▒▒▒▒██  ░░░░                ████                            && echo          ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒██              ░░██  ░░████                            && echo          ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒██░░                  ██▒▒██                            && echo          ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒██░░        ░░░░    ▓▓▓▓▒▒██                            && echo          ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒▒▒██░░      ░░    ██▒▒▒▒▒▒██                            && echo          ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒██░░░░░░    ████▒▒██▒▒▒▒██                            && echo          ██▒▒▒▒▒▒▒▒▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒██▒▒▒▒██████████▒▒▒▒▒▒██▒▒▒▒██                            && echo            ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓▓████░░░░      ████▒▒██▒▒▒▒██                            && echo            ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░            ██▒▒██▒▒▒▒██                          && echo            ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░░░              ██▓▓▒▒▒▒██                          && echo            ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓▓░░██░░░░                  ██████                          && echo            ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░░░                      ██  ██████                  && echo              ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░██░░░░                      ████    ████              && echo              ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░██░░░░░░                        ████░░░░▓▓██          && echo              ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░██░░░░██░░░░                        ████    ██        && echo              ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░░░██░░██░░░░████░░░░                        ████  ██      && echo              ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░██░░░░░░░░████░░░░                        ██  ██    && echo              ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░██░░  ░░░░░░░░████░░░░                          ██  && echo              ██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░░░██░░██░░    ░░░░░░░░████░░░░                      ██  && echo            ▓▓▓▓▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒██░░░░██░░██░░      ░░░░░░░░░░▒▒▓▓░░░░░░                ░░██&& echo            ██▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒██░░██░░██░░░░      ░░░░░░██░░░░██████░░░░              ██&& echo            ██▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒████░░░░██░░██░░░░░░░░░░████      ░░░░░░████░░░░          ██&& echo            ██▒▒▒▒██  ██▒▒▒▒▒▒▒▒▒▒████░░░░██░░██░░▓▓▒▒▓▓▓▓░░░░  ▓▓▓▓  ░░░░░░░░▓▓▓▓░░░░░░░░▓▓  && echo            ██▒▒▒▒██  ██▒▒▒▒▒▒▒▒▒▒▓▓██░░░░████████░░      ▓▓▓▓▓▓░░░░████░░░░██    ██▓▓▓▓▓▓    && echo          ██▒▒▒▒▒▒██    ██▒▒▒▒▒▒▓▓  ██████░░░░░░░░████████░░░░░░░░░░░░░░████                  && echo          ██▒▒▒▒██      ██▒▒▒▒▒▒██  ██░░░░████████░░░░░░░░░░░░░░    ░░░░██                    && echo          ██▒▒▒▒██      ██▒▒▒▒██      ▓▓▓▓░░░░░░░░░░░░░░░░░░░░░░      ░░██                    "
greetz = "echo # IDK MAN... this programs is fking ************** && echo ############################################### && echo # Nothing to see but, this program created by # && echo #                                             # && echo #           .▄▄ ·  ▄▄▄·  ▐ ▄ .▄▄ ·            # && echo #           ▐█ ▀. ▐█ ▀█ •█▌▐█▐█ ▀.            # && echo #           ▄▀▀▀█▄▄█▀▀█ ▐█▐▐▌▄▀▀▀█▄           # && echo #           ▐█▄▪▐█▐█ ▪▐▌██▐█▌▐█▄▪▐█           # && echo #            ▀▀▀▀  ▀  ▀ ▀▀ █▪ ▀▀▀▀            # && echo #           ·▄▄▄▄  ▄▄▄ ..▄▄ · ▄• ▄▌           # && echo #           ██▪ ██ ▀▄.▀·▐█ ▀. █▪██▌           # && echo #           ▐█· ▐█▌▐▀▀▪▄▄▀▀▀█▄█▌▐█▌           # && echo #           ██. ██ ▐█▄▄▌▐█▄▪▐█▐█▄█▌           # && echo #           ▀▀▀▀▀•  ▀▀▀  ▀▀▀▀  ▀▀▀            # && echo #                                             # && echo #          Created by me SANSDESU :)          # && echo ###############################################"

# StartStartStartStartStartStart =========================================
import os, sys
os.system(f'start /wait cmd /c "@ECHO OFF && {greetzz} && {greetz} && timeout /t 2 /nobreak"')
# && pip install customtkinter easygui CTkMessagebox pyperclip rarfile pyzipper # i use this for download requirements library

# os.chdir(sys._MEIPASS) # use this when making exe file with one file (copy all file to temp file), and remove or comment this when making exe file but with one directory

import tkinter as tk
import customtkinter as root
from CTkMessagebox import CTkMessagebox as msg
import easygui
import pyzipper
import zipfile
import rarfile
import pyperclip
import time
import json

# Set default path =========================================
user_doc_path = os.path.expanduser('~\\Documents\\ZipBrute')
unrarTool = "./src/UnRAR.exe"
settFile = os.path.expanduser('~\\Documents\\ZipBrute\\setting.json')
iconWindow = "./src/smile.ico"
defPw = "./src/def-pw.txt"

rarfile.UNRAR_TOOL = unrarTool

if not os.path.exists(user_doc_path):
    os.makedirs(user_doc_path)

# ROOT always on TOP :) =========================================
root.set_appearance_mode("dark")
root.set_default_color_theme("green")

rootWindows = root.CTk()
rootWindows.resizable(False, False)
show = False

def windowSize(ws):
    if ws == 1:
        window_height = 500
        window_width = 720
        rootWindows.geometry("{}x{}".format(window_width, window_height))

        rootFrame.pack_forget()
        outputFrame.pack_forget()
        userFrame.pack_forget()
        scanFrame.pack_forget()

        settingFrame.pack(pady=20, padx=(0, 20), fill="both", expand=True, side="right")
        rootFrame.pack(pady=20,padx=20, fill="both", expand=True)

        outputFrame.pack(pady=(0, 20), padx=20, fill="both", expand=True)
        userFrame.pack(pady=10, padx=10, fill="both", expand=True, side="left")
        scanFrame.pack(pady=10, padx=(0, 10), fill="both", expand=True, side="right")

        executeButton.configure(state="disabled")
        executeButton.update()
        selectButton.configure(state="disabled")
        selectButton.update()
        wordlistButton.configure(state="disabled")
        wordlistButton.update()
    else:
        window_height = 500
        window_width = 500
        rootWindows.geometry("{}x{}".format(window_width, window_height))

        settingFrame.pack_forget()
        executeButton.configure(state="normal")
        executeButton.update()
        selectButton.configure(state="normal")
        selectButton.update()
        wordlistButton.configure(state="normal")
        wordlistButton.update()

window_height = 500
window_width = 500

screen_width = rootWindows.winfo_screenwidth()
screen_height = rootWindows.winfo_screenheight()

x_cordinate = int((screen_width/2) - (window_width/2))
y_cordinate = int((screen_height/2) - (window_height/2))
rootWindows.geometry("{}x{}+{}+{}".format(window_width, window_height, x_cordinate, y_cordinate))

rootWindows.title("ZIP Brute by SANSDESU")
rootWindows.iconbitmap(iconWindow)

settingFrame = root.CTkFrame(master=rootWindows)

rootFrame = root.CTkFrame(master=rootWindows)
rootFrame.pack(pady=20,padx=20, fill="both", expand=True)

outputFrame = root.CTkFrame(master=rootWindows)
outputFrame.pack(pady=(0, 20), padx=20, fill="both", expand=True)

userFrame = root.CTkFrame(master=outputFrame)
userFrame.pack(pady=10, padx=10, fill="both", expand=True, side="left")

scanFrame = root.CTkFrame(master=outputFrame)
scanFrame.pack(pady=10, padx=(0, 10), fill="both", expand=True, side="right")

# for Show/Hide Setting, simple?, i don't think so =========================================
def settingRun():
    global show
    if show == False:
        load_setting()
        windowSize(1)
        show = True
    else:
        windowSize(0)
        save_setting()
        show = False

# Just Variable and random things =========================================
slcVarText = tk.StringVar()
wrdVarText = tk.StringVar()
numVarText = tk.StringVar()
current_value = tk.DoubleVar()
methodMenuValue = tk.StringVar()

wordTail = "unknown"
zipTail = "unknown"
wordText = "unknown"
archiveFile = "File is"

wrdVarText.set("Default")
cntList = 0
totalpw = "-"
cancelScan = 0
isRar = False

cntScan = f"Scanning Wordlist [{cntList}/{totalpw}]"

method_list = ["Test Archive", "Extract All"]

if not os.path.exists(settFile):
    methodMenuValue.set("Test Archive")
    current_value.set(1.0)
    setting_json_new = {
        "delay_scan": 1.0,
        "test_method": "Test Archive"
    }
    json_object_new = json.dumps(setting_json_new, indent=4)

    new = open(settFile, "w")
    new.writelines(json_object_new)
    new.close()

def credits():
    cr = root.CTkLabel(master=settingFrame, height=20, text="Created by SANSDESU:", text_color="#8a8a8a")
    cr.pack(pady=0, padx=10, anchor="w")
    cr1 = root.CTkLabel(master=settingFrame, height=20, text="Web: sansdesu.rf.gd", text_color="#8a8a8a")
    cr1.pack(pady=0, padx=10, anchor="w")
    cr2 = root.CTkLabel(master=settingFrame, height=20, text="IG: @sansdesu.pz", text_color="#8a8a8a")
    cr2.pack(pady=0, padx=10, anchor="w")
    cr3 = root.CTkLabel(master=settingFrame, height=20, text="Yt: @sansdesu", text_color="#8a8a8a")
    cr3.pack(pady=0, padx=10, anchor="w")

# get slider value and store it into variable =========================================
def get_current_value():
    return '{: .2f}'.format(float(current_value.get()))

def slider_changed(event):
    numVarText.set(str(get_current_value()))

# Set widget setting =========================================
delayNum = root.CTkEntry(master=settingFrame, width=50, height=5, textvariable=numVarText, text_color="#8a8a8a")
delaySlider = root.CTkSlider(master=settingFrame, width=180, from_=0.1, to=5, variable=current_value, command=slider_changed)
methodMenu = root.CTkOptionMenu(master=settingFrame, width=180, variable=methodMenuValue, values=method_list, text_color="#252525")

# Definition =========================================
# Add line into window? =========================================
def line(r):
    if r == "set":
        l = root.CTkLabel(master=settingFrame, text_color="#4d4d4d", text="──────────", font=("Bebas", 18)).pack(padx=10)
    else:
        l = root.CTkLabel(master=rootFrame, text_color="#4d4d4d", text="────────────────────────────────────────────────────────────", font=("Bebas", 18)).pack(padx=10)

# Save and Load setting.json =========================================
def save_setting():
    current_value.set(delayNum.get())
    setting_json = {
        "delay_scan": float(get_current_value()),
        "test_method": methodMenuValue.get()
    }
    json_object = json.dumps(setting_json, indent=4)

    new = open(settFile, "w")
    new.writelines(json_object)
    new.close()

def load_setting():
    global delaySlider
    if os.path.exists(settFile):
        with open(settFile) as jsonFile:
            jsonObject = json.load(jsonFile)
            jsonFile.close()


        current_value.set(str(jsonObject['delay_scan']))
        numVarText.set(str(get_current_value()))
        delaySlider.set(float(jsonObject['delay_scan']))
        delay = float(jsonObject['delay_scan'])

        if jsonObject['test_method'] == "Test Archive":
            methodMenu.set(method_list[0])
        else:
            methodMenu.set(method_list[1])
    else:
        methodMenuValue.set("Test Archive")
        current_value.set(1.0)
        save_setting()

def load_delay():
    with open(settFile) as jsonFile:
        jsonObject = json.load(jsonFile)
        jsonFile.close()
    delay = float(jsonObject['delay_scan'])
    return delay

def load_method():
    with open(settFile) as jsonFile:
        jsonObject = json.load(jsonFile)
        jsonFile.close()
    method = str(jsonObject['test_method'])
    return method

# pick zip or rar file =========================================
def pickZip():
    file = easygui.fileopenbox(msg="Choose a zip file", default=r"C:/")
    slcVarText.set(file)

# pick wordlist file =========================================
def pickWordlist():
    file = easygui.fileopenbox(msg="Choose a wordlist file", default=r"C:/")
    if file == None:
        wrdVarText.set("Default")
    else:
        wrdVarText.set(file)

# Save password into .txt or other format to a file =========================================
def save():
    file = easygui.filesavebox(title="Save file as", default="*.txt")
    if scanOut.cget("text") == "unknown":
        msg(title="Warning!", message="Nothing Saved!", icon="warning")
    else:
        text = "Password: "+scanOut.cget("text")
        new = open(file, "a+")
        new.writelines(text)
        new.close()
        msg(title="Success!", message="Password Saved!", icon="check", option_1="Ok")

# to copy password of course =========================================
def copy():
    if not scanOut.cget("text") or scanOut.cget("text") == "unknown":
        msg(title="Warning!", message="Nothing copied!", icon="warning")
    else:
        pyperclip.copy(scanOut.cget("text"))
        msg(title="Success!", message="Password Copied!", icon="check", option_1="Ok")

# umm.. this is for cancel scanning =========================================
def cancel():
    global cancelScan
    cancelScan = 1

# for execute programs, this is work for me =========================================
def exec():
    execute()

# umm.. for getting file size maybe? =========================================
def blocks(files, size=65536):
    while True:
      b = files.read(size)
      if not b: break
      yield b



# add header gui to rootFrame =========================================
load_setting()
settingButton = root.CTkButton(master=rootFrame, width=20, height=20,text="⚙", font=("Bebas", 15), command=settingRun, hover_color="#3b3b3b", fg_color="transparent", bg_color="transparent", anchor="center")#text_color="#2FA572" ,
settingButton.place(x=10, y=15)
titleText = root.CTkLabel(master=rootFrame, text="ZIP Brute", font=("Bebas", 30)).pack(pady=10, padx=10)
line(0)

# add Zip gui to rootFrame =========================================
selectText = root.CTkLabel(master=rootFrame, text="Select Archive File :", font=("Bebas", 15)).pack(pady=0, padx=10, anchor="w")
selectZip = root.CTkEntry(master=rootFrame, state="disabled", width=290, placeholder_text="Archive path", textvariable=slcVarText, text_color="#8a8a8a")
selectZip.pack(padx=10, anchor="w")
selectButton = root.CTkButton(master=rootFrame, text="Browse", font=("Bebas", 15), command=pickZip)
selectButton.place(x=310, y=112)

# add Wordlist gui to rootFrame =========================================
wordlistText = root.CTkLabel(master=rootFrame, text="Select Wordlist File :", font=("Bebas", 15)).pack(pady=(10,0), padx=10, anchor="w")
selectWordlist = root.CTkEntry(master=rootFrame, state="disabled", width=290, placeholder_text="Wordlist path", textvariable=wrdVarText, text_color="#8a8a8a")
selectWordlist.pack(padx=10, anchor="w")
wordlistButton = root.CTkButton(master=rootFrame, text="Browse", font=("Bebas", 15), command=pickWordlist)
wordlistButton.place(x=310, y=178)

# add output info gui to userFrame =========================================
outZipText = root.CTkLabel(master=userFrame, text=archiveFile, font=("Bebas", 15))
outZipText.pack(pady=(10,0), padx=10)
outZip = root.CTkLabel(master=userFrame, width=200, text=zipTail, text_color="#8a8a8a")
outZip.pack(padx=10)

outWordText = root.CTkLabel(master=userFrame, text="Wordlist File", font=("Bebas", 15)).pack(padx=10)
outWord = root.CTkLabel(master=userFrame, width=200, text=wordTail, text_color="#8a8a8a")
outWord.pack(padx=10)

# add output scan gui to scanFrame =========================================
scanOutText = root.CTkLabel(master=scanFrame, text=cntScan, font=("Bebas", 15))
scanOutText.pack(padx=10)
scanOut = root.CTkLabel(master=scanFrame, width=200, text=wordText, text_color="#8a8a8a")
scanOut.pack(padx=10)

saveButton = root.CTkButton(master=scanFrame, width=100, text="Save", font=("Bebas", 20), command=save)
copyButton = root.CTkButton(master=scanFrame, width=100, text="Copy", font=("Bebas", 20), command=copy)

cancelScanButton = root.CTkButton(master=scanFrame, width=100, text="Cancel Scanning", font=("Bebas", 20), command=cancel)

# Execute button for fun :) =========================================
executeButton = root.CTkButton(master=rootFrame, width=500, text="Execute", font=("Bebas", 20), command=exec)
executeButton.pack(pady=(20,0) ,padx=10)
line(0)

# and this is for gui settingFrame =========================================
settingTitle = root.CTkLabel(master=settingFrame, text="Setting", font=("Bebas", 30)).pack(pady=10, padx=10)
line("set")

delayText = root.CTkLabel(master=settingFrame, text="Scan Delay :", font=("Bebas", 15)).pack(pady=0, padx=10, anchor="w")
delayNum.place(x=84 , y=84)
delaySlider.pack(pady=(0,10), padx=10, anchor="w")
methodText = root.CTkLabel(master=settingFrame, text="Test password method :", font=("Bebas", 15)).pack(pady=0, padx=10, anchor="w")
methodMenu.pack(pady=(0,10), padx=10, anchor="w")

settLoc = root.CTkLabel(master=settingFrame, text="*Setting file saved in:", text_color="#8a8a8a")
settLoc.pack(padx=10, anchor="w")
settLocDoc = root.CTkTextbox(master=settingFrame, wrap="none", activate_scrollbars=True , width=180, height=20, text_color="#8a8a8a")
settLocDoc.insert("0.0", settFile)
settLocDoc.pack(pady=(0,100), padx=10, anchor="w")
settLocDoc.configure(state="disabled")
settLocDoc.update()
credits()
# it's getting crazier now =========================================
def execute():
    load_setting()
    if not slcVarText.get() or slcVarText.get() == "None":
        msg(title="Warning!", message="zip file path don't be empty!", icon="warning")

    else:
        if wrdVarText.get() == "Default":
            wordlistPath = defPw
            wordTail = defPw
        else:
            wordlistPath = wrdVarText.get()

        password_list = wordlistPath
        archive_file = slcVarText.get()

        if not wordlistPath == defPw:
            wordHead, wordTail = os.path.split(password_list)

        zipHead, zipTail = os.path.split(archive_file)

        outWord.configure(text=wordTail)
        outWord.update()
        outZip.configure(text=zipTail)
        outZip.update()

        executeButton.configure(state="disabled")
        executeButton.update()
        selectButton.configure(state="disabled")
        selectButton.update()
        wordlistButton.configure(state="disabled")
        wordlistButton.update()
        settingButton.configure(state="disabled")
        settingButton.update()
        cancelScanButton.pack(pady=10 ,padx=10)
        saveButton.pack_forget()
        copyButton.pack_forget()

        try:
            obj = zipfile.ZipFile(archive_file)
            cnt = len(list(open(password_list, "rb")))
            archiveFile = "File is Zip"
            outZipText.configure(text=archiveFile)
            outZipText.update()
            isRar = False
        except:
            try:
                obj = rarfile.RarFile(archive_file)
                cnt = len(list(open(password_list, "rb")))
                archiveFile = "File is Rar"
                outZipText.configure(text=archiveFile)
                outZipText.update()
                isRar = True
            except:
                msg(title="Warning!", message="File not a archive file!", icon="warning")

        passwd_size = os.path.getsize(password_list) >> 20
        if passwd_size < 100:
            with open(password_list) as f:
                totalpw = sum(bl.count("\n") for bl in blocks(f))
        else:
                totalpw = "-"
        #crack_password(password_list, obj)

        if crack_password(password_list, obj, totalpw, archive_file, isRar) == False:
            if cancelScan == 1:
                msg(title="Not Found!", message="Scanning Canceled!", icon="cancel")
            else:
                msg(title="Not Found!", message="Password not found in this file!", icon="cancel")

def setToNormal():
    cancelScanButton.pack_forget()
    executeButton.configure(state="normal")
    executeButton.update()
    selectButton.configure(state="normal")
    selectButton.update()
    wordlistButton.configure(state="normal")
    wordlistButton.update()
    settingButton.configure(state="normal")
    settingButton.update()

def pw_found(idx, word):
    saveButton.pack(pady=(10,0) ,padx=10, side="left")
    copyButton.pack(pady=(10,0) ,padx=(0, 10), side="right")
    setToNormal()
    msg(title="Found!", message=f"Password found at line {idx}!\nPassword is: {word.decode()}", icon="check")

# crack or attack? =========================================
def crack_password(password_list, obj, totalpw, archive_file, rarIdk):
    idx = 0
    cntList = 0

    global cancelScan
    cancelScan = 0

    with open(password_list, 'rb') as file:
        for line in file:
            rootWindows.update()
            if cancelScan == 1:
                setToNormal()
                return False

            # for word in tqdm(file, total=n_pass, unit='word'): idk, some comments maybe
            for word in line.split():
                cntList+=1
                idx += 1
                cntScan = f"Scanning Wordlist [{cntList}/{totalpw}]"
                scanOutText.configure(text=cntScan)
                scanOutText.update()

                if cancelScan == 1:
                    setToNormal()
                    return False

                scanOut.configure(text=word.decode())
                scanOut.update()

                # print(word.strip()) just for
                # print(str(load_method())) DEBUGGING

                if rarIdk == True:
                    try:
                        if load_method() == "Test Archive":
                            obj.setpassword(word)
                            obj.testrar()
                        else:
                            obj.extractall(pwd=word)

                        pw_found(idx, word)
                        return True
                    except:
                        time.sleep(load_delay())
                        continue
                else:
                    try:
                        if load_method() == "Test Archive":
                            obj.setpassword(word)
                            obj.testzip()
                        else:
                            obj.extractall(pwd=word)

                        #password_encoded = bytes(word.encode('utf-8'))    password found!
                        #print("Password found at line", idx)                    or
                        #print("Password is", word.decode())                    NOT?

                        pw_found(idx, word)
                        return True
                    except:
                        with pyzipper.AESZipFile(archive_file) as aes:
                            try:
                                if load_method() == "Test Archive":
                                    aes.setpassword(word)
                                    aes.testzip()
                                else:
                                    aes.extractall(pwd=word)

                                pw_found(idx, word)
                                return True
                            except:
                                time.sleep(load_delay())
                                continue
    return False


rootWindows.mainloop()

# IDK MAN... this programs is fking **************
##############################################################################
# ⣾⣿⠿⠿⠶⠿⢿⣿⣿⣿⣿⣦⣤⣄⢀⡅⢠⣾⣛⡉⠄⠄ Nothing to see but, this program created by #
# ⡋⣡⣴⣶⣶⡀⠄⠄⠙⢿⣿⣿⣿⣿⣿⣴⣿⣿⣿⢃⣤⣄                                             #
# ⣇⠻⣿⣿⣿⣧⣀⢀⣠⡌⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠿           .▄▄ ·  ▄▄▄·  ▐ ▄ .▄▄ ·            #
# ⣿⣷⣤⣤⣤⣬⣙⣛⢿⣿⣿⣿⣿⣿⣿⡿⣿⣿⡍⠄⠄⢀           ▐█ ▀. ▐█ ▀█ •█▌▐█▐█ ▀.            #
# ⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣿⣿⣿⣿⣿⢇⣿⣿⡷⠶⠶⢿           ▄▀▀▀█▄▄█▀▀█ ▐█▐▐▌▄▀▀▀█▄           #
# ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣽⣿⣿⣿⡇⣿⣿⣿⣿⣿⣿⣷           ▐█▄▪▐█▐█ ▪▐▌██▐█▌▐█▄▪▐█           #
# ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿            ▀▀▀▀  ▀  ▀ ▀▀ █▪ ▀▀▀▀            #
# ⣌⣛⣻⣿⣿⣧⠙⠛⠛⡭⠅⠒⠦⠭⣭⡻⣿⣿⣿⣿⣿⣿           ·▄▄▄▄  ▄▄▄ ..▄▄ · ▄• ▄▌           #
# ⣿⣿⣿⣿⣿⣿⡆⠄⠄⠄⠄⠄⠄⠄⠄⠹⠈⢋⣽⣿⣿⣿           ██▪ ██ ▀▄.▀·▐█ ▀. █▪██▌           #
# ⣿⣿⣿⣿⣿⣿⣿⠄⣴⣿⣶⣄⠄⣴⣶⠄⢀⣾⣿⣿⣿⣿           ▐█· ▐█▌▐▀▀▪▄▄▀▀▀█▄█▌▐█▌           #
# ⠻⣿⣿⣿⣿⣿⣿⡄⢻⣿⣿⣿⠄⣿⣿⡀⣾⣿⣿⣿⣿⣛           ██. ██ ▐█▄▄▌▐█▄▪▐█▐█▄█▌           #
# ⠄⠈⠛⢿⣿⣿⣿⠁⠞⢿⣿⣿⡄⢿⣿⡇⣸⣿⣿⠿⠛⠁           ▀▀▀▀▀•  ▀▀▀  ▀▀▀▀  ▀▀▀            #
# ⠄⠄⠄⠄⠉⠻⣿⣿⣾⣦⡙⠻⣷⣾⣿⠃⠿⠋⠁⠄⠄⠄                                             #
# ⣶⣶⣮⣥⣒⠲⢮⣝⡿⣿⣿⡆⣿⡿⠃⠄⠄⠄⠄⠄⠄⠄                 me SANSDESU :)              #
##############################################################################